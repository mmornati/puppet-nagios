puppet-nagios
=============

Nagios server installation and checks definition

## Puppet master required configuration
To use this plugin you must have a puppetdb installed, and a puppetmaster configured to use it to store and retrieve information:

```
[master]
  # a list:
  reports = store, http, puppetdb

  # a multi-directory modulepath:
  modulepath = /etc/puppet/modules:/usr/share/puppet/modules
  storeconfigs = true
  storeconfigs_backend = puppetdb
  node_terminus = exec

```

## Usage of this plugin

To install a nagios server on a node:

```
nagios.demo.net {
    include nagios::server
}
```

On any host to control you can add nagios classes where you defined checks.
In this example I've created a single class with all base checks for a Linux
server.

```
node1 {
    include nagios::default
}
```

```
node2 {
    include nagios::default
    include nagios::webserver
}
```

You will have automatic generated file (on your nagios server) for any node you
configured. For example, for any host, you will have a file named ''/etc/nagios/conf.d/host_node1.demo.lan.cfg'' containing
information like:

```
# HEADER: This file was autogenerated at Thu Jan 30 22:30:07 +0100 2014
# HEADER: by puppet.  While it can still be managed manually, it
# HEADER: is definitely not recommended.
define host {
        address                        192.168.0.101
        check_command                  check-host-alive!3000.0,80%!5000.0,100%!10
        host_name                      node1.demo.lan
        hostgroups                     linux-servers
        max_check_attempts             3
}
```
and another file for services (''host_services_node1.demo.lan.cfg'')
and the nagios service, if any chages are made, it will be automatically restarted.

